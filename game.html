<!DOCTYPE html>
<html>
<head>
<title> Car Game! </title>
<script src="simply.js"></script>
<script>
function start(){

	//north southbound
	var moveUp = true;
	var moveDown = true;
	//east west bound
	var moveLeft = false;
	var moveRight = false;
	
	var carsUp = [];
	var carsDown = [];
	var carsLeft = [];
	var carsRight = [];

	sjs.open("target",1000,1000);

	var background = new sjs.Image("Images/map-01.jpg"); 
	background.setSize(sjs.getWidth(),sjs.getHeight()); 

	//up drivers
	var wall = new sjs.Image("Images/wall.png");
	wall.type= "wall";
	wall.setSize(100,1);
	wall.moveTo(sjs.getWidth()/2 -50,sjs.getHeight()/2+25);
	
	var upDZone = new sjs.Image("Images/wall.png");
	upDZone.type = "upDZone";
	upDZone.setSize(100,1);
	upDZone.moveTo(sjs.getWidth()/2-50,sjs.getHeight()/2+150);
	
	//down drivers
	var downWall = new sjs.Image("Images/wall.png");
	downWall.type= "downCarWall";
	downWall.setSize(100,1);
	downWall.moveTo(sjs.getWidth()/2 -50,sjs.getHeight()/2-26);
	
	var downDZone = new sjs.Image("Images/wall.png");
	downDZone.type = "downDZone";
	downDZone.setSize(100,1);
	downDZone.moveTo(sjs.getWidth()/2-50,sjs.getHeight()/2-151);
	
	//left drivers
	var leftWall = new sjs.Image("Images/wall.png");
	leftWall.type= "leftCarWall";
	leftWall.setSize(1,100);
	leftWall.moveTo(sjs.getWidth()/2 +30,sjs.getHeight()/2-50);
	
	var leftDZone = new sjs.Image("Images/wall.png");
	leftDZone.type = "leftDZone";
	leftDZone.setSize(1,100);
	leftDZone.moveTo(sjs.getWidth()/2+150,sjs.getHeight()/2-50);
	
	//Right drivers
	var rightWall = new sjs.Image("Images/wall.png");
	rightWall.type= "rightCarWall";
	rightWall.setSize(1,100);
	rightWall.moveTo(sjs.getWidth()/2 -23,sjs.getHeight()/2-50);
	
	var rightDZone = new sjs.Image("Images/wall.png");
	rightDZone.type = "rightDZone";
	rightDZone.setSize(1,100);
	rightDZone.moveTo(sjs.getWidth()/2-150,sjs.getHeight()/2-50);
	
	
	
	
	//light for northbound & southbound
	var light = new sjs.Image("Images/greenlight.png");
	light.setSize(75,150);
	light.moveTo(sjs.getWidth()-300, sjs.getHeight()-100);
	
	//light for east and westbound
	var lightEastWest = new sjs.Image("Images/redlight.png");
	lightEastWest.setSize(75,150);
	lightEastWest.moveTo(10, 200);


	var player = new sjs.Image("Images/car.png");
	player.setSize(15,30);
	player.type = "car";
	player.setHFlipImages("Images/car.png", "Images/car.png");
	player.friction = .1;
	player.accel = .5; 


	//light for north and south
	light.onMouseUp(function(){
		if(moveUp){
			light.setImage("Images/redlight.png",75,150);
			moveUp = false;
			moveDown = false;
			return;
		}
		else{
			light.setImage("Images/greenlight.png",75,150);
			moveUp = true;
			moveDown = true;
			carsUp.forEach(function(car,index){
				
				car.type="none";
				car.stop();
				car.friction = 0;
				car.accel = .5;				
				car.pushUp(1);
				
			});
			carsDown.forEach(function(car,index){
				car.type="none";
				car.stop();
				car.friction = 0;
				car.accel = .5;				
				car.pushDown(1);
			});
			return;
		}
	});
	
	//light east and west
	lightEastWest.onMouseUp(function(){
		if(moveLeft){
			lightEastWest.setImage("Images/redlight.png",75,150);
			moveLeft = false;
			moveRight = false;
			return;
		}
		else{
			lightEastWest.setImage("Images/greenlight.png",75,150);
			moveLeft = true;
			moveRight = true;
			carsLeft.forEach(function(car,index){
				
				car.type="none";
				car.stop();
				car.friction = 0;
				car.accel = .5;				
				car.pushLeft(1);
				
			});
			carsRight.forEach(function(car,index){
				car.type="none";
				car.stop();
				car.friction = 0;
				car.accel = .5;				
				car.pushRight(1);
			});
			return;
		}
	});
	
	
	
	
	
	

	setInterval(function(){
		//car up
		var newCarUp = new sjs.Image("Images/car.png");
		newCarUp.type = "car";
		newCarUp.moveTo(sjs.getWidth()/2 + 9, sjs.getHeight());
		newCarUp.setSize(15,30);
		newCarUp.friction = 0;
		newCarUp.accel = .5; 
		newCarUp.pushUp(1);
		newCarUp.noBounds = true;
		//car down
		var newCarDown = new sjs.Image("Images/downcar.png");
		newCarDown.type = "downCar";
		newCarDown.moveTo(sjs.getWidth()/2 - 14, -100);
		newCarDown.setSize(15,30);
		newCarDown.friction = 0;
		newCarDown.accel = .3; 
		newCarDown.pushDown(.7);
		newCarDown.noBounds = true;
		//car left
		var newCarLeft = new sjs.Image("Images/leftcar.png");
		newCarLeft.type = "leftCar";
		newCarLeft.moveTo(sjs.getWidth() + 100 , sjs.getHeight()/2 - 20);
		newCarLeft.setSize(30,15);
		newCarLeft.friction = 0;
		newCarLeft.accel = .3; 
		newCarLeft.pushLeft(1);
		newCarLeft.noBounds = true;
		//car right
		var newCarRight = new sjs.Image("Images/rightcar.png");
		newCarRight.type = "rightCar";
		newCarRight.moveTo(-100 , sjs.getHeight()/2+3);
		newCarRight.setSize(30,15);
		newCarRight.friction = 0;
		newCarRight.accel = .3; 
		newCarRight.pushRight(1);
		newCarRight.noBounds = true;
		

	},2000);


	//when cars hit cars going up
	sjs.onHit("car","car", function(p,car){ 
		
		car.stop();
		p.stop();
		carsUp.push(car);
		
	});	
	//when cars hit cars going down
	sjs.onHit("downCar","downCar", function(p,car){ 
		
		car.stop();
		p.stop();
		carsDown.push(car);
		
	});
	//when cars hit cars going left
	sjs.onHit("leftCar","leftCar", function(p,car){ 
		
		car.stop();
		p.stop();
		carsLeft.push(car);
		
	});
	//when cars hit cars going right
	sjs.onHit("rightCar","rightCar", function(p,car){ 
		
		car.stop();
		p.stop();
		carsRight.push(car);
		
	});
	
	

	//delima zone when light is off 
	//traffic going up
	sjs.onHit("upDZone","car",function(wall,car){
		if(moveUp == false){
			car.friction = 0.038;
			carsUp.push(car);			
		}
	});

	//traffic going down
	sjs.onHit("downDZone","downCar",function(wall,car){
		if(moveDown == false){
			car.friction = 0.013;
			carsDown.push(car);			
		}
	});
	
	//traffic going left
	sjs.onHit("leftDZone","leftCar",function(wall,car){
		if(moveLeft == false){
			car.friction = 0.021;
			carsLeft.push(car);			
		}
	});
	
	//traffic going Right
	sjs.onHit("rightDZone","rightCar",function(wall,car){
		if(moveRight == false){
			car.friction = 0.021;
			carsRight.push(car);			
		}
	});
	
	//destroy cars on drivng north
	sjs.onHit("car","top_screen", function(car,y){
		car.destroy();
	});
	//destroy cars driving south
	sjs.onHit("downCar","bottom_screen", function(car,y){
		car.destroy();
	});
	//destroy cars driving west
	sjs.onHit("leftCar","left_screen", function(car,y){
		car.destroy();
	});
	//destroy cars driving east
	sjs.onHit("rightCar","right_screen", function(car,y){
		car.destroy();
	});
	
	
	
	
	//move the car
	sjs.keyDown(RIGHT_KEY, function(){ 
	player.faceRight();
	player.pushRight();

	});


	sjs.keyDown(LEFT_KEY, function(){ 
	player.faceLeft();
	player.pushLeft();

	});
	sjs.keyDown(DOWN_KEY, function(){ 
	player.pushDown();

	});
	sjs.keyDown(UP_KEY, function(){ 
	player.pushUp();

});





/*
setInterval(function(){
var newCrumb = new sjs.Image("Images/crumbs.png");
newCrumb.type = "crumbs";
newCrumb.friction = .2;
newCrumb.setGravity();
newCrumb.centerH();
newCrumb.noBounds = true;
}, 5000);



var enemy;
enemy.scaleSize(.5 + Math.random() * 1.2);
enemy.moveTo(-enemy.getWidth(), Math.random()*(enemy.getClamp().y)); 
setInterval(function(){
if(Math.random() > 0.5){ 
var enemy = new sjs.Image("Images/fish2_right.png");
enemy.type = "enemy";
enemy.setSize(100,50);
enemy.pushRight(3);
enemy.noBounds = true;
enemy.friction = 0;	
} else { 
var enemy = new sjs.Image("Images/fish2_left.png");
enemy.type = "enemy";
enemy.setSize(100,50);
enemy.pushLeft(3);
enemy.noBounds = true;
enemy.friction = 0; 
}
},1000);












sjs.onHit("player","crumbs",function(x,y){
x.grow(60,30);
setTimeout(function(){
x.grow(-60,-30);
}, 4000);
y.destroy();
});

sjs.onHit("crumbs","bottom_screen",function(x,y){
x.destroy();
});

sjs.right_screen.offset(300);
sjs.left_screen.offset(-300);





enemy.scaleSize(.5 + Math.random() * 1.2);
enemy.moveTo(sjs.getWidth(), Math.random()*(enemy.getClamp().y)); 

sjs.onHit("enemy",["left_screen", "right_screen"], function(x,y){
x.destroy();
});



sjs.onHit("player","enemy", function(x,y){ 
if(x.getWidth() > y.getWidth() && 
x.getHeight() > y.getHeight()) {
x.grow(10,5);
} else {
x.destroy(); 
}
y.destroy(); 
});




*/























function sleep(miliseconds) {
   var currentTime = new Date().getTime();

   while (currentTime + miliseconds >= new Date().getTime()) {
   }
}














} //end start
</script>
</head>
<body onload="start()">

<div id="target" style="margin:auto;background:grey;"></div>
</body>
</html>